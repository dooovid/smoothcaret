//smoothCaret.js made by doovid <3
function css(a,b){return window.getComputedStyle(a,null).getPropertyValue(b)}function getTextWidth(b,c){let a=document.querySelector("#sc-canvas").getContext("2d");return a.font=c,a.measureText(b).width}const styleString=".sc-container{display:grid;grid-template-columns:repeat(1,1fr);}.smoothCaretInput{grid-column:1/3;caret-color:transparent}.caret{grid-column:2/-2;align-self:center;transition:.2s;opacity: 0;}.caret,.smoothCaretInput{grid-row:1/2}",style=document.createElement("style"),canvElem=document.createElement("canvas"),passwordChar=navigator.userAgent.match(/firefox|fxios/i)?"\u25CF":"\u2022";style.innerText=".sc-container{display:grid;grid-template-columns:repeat(1,1fr);}.smoothCaretInput{grid-column:1/3;caret-color:transparent}.caret{grid-column:2/-2;align-self:center;transition:.2s;opacity: 0;}.caret,.smoothCaretInput{grid-row:1/2}",document.head.append(style),canvElem.id="sc-canvas",canvElem.style.display="none",document.body.appendChild(canvElem);let smoothCarets=[],caretPosString;class SmoothCaret{constructor(b,a,c){this.font="\u2022"!=passwordChar||"password"!=a.type||navigator.userAgent.match(/chrome|chromium|crios/i)?`${css(a,"font-size")} ${css(a,"font-family")}`:`${parseFloat(css(a,"font-size"))+6.25}px ${css(a,"font-family")}`,this.maxMargin=parseInt(css(a.parentElement,"width"))-10,this.caretMargin=parseInt(css(a,"padding-left"))+2,this.caretWidth=parseInt(b.style.width),this.letterSpacing=parseInt(css(a,"letter-spacing"))?parseInt(css(a,"letter-spacing")):0,this.caretElem=b,this.inputElem=a,this.textWidth=void 0,this.index=c}init(){console.log(this.letterSpacing),this.inputElem.dataset.sc=this.index,this.pw_ratio="password"==this.inputElem.type?getTextWidth(passwordChar+passwordChar,this.font)-getTextWidth(passwordChar,this.font):null,this.inputElem.addEventListener("input",a=>this.update("password"===a.target.type?Array(a.target.value.length+1).join(passwordChar):a.target.value)),this.inputElem.addEventListener("blur",()=>{this.caretElem.style.opacity="",this.caretElem.style.transform=""})}update(a){this.caretElem.style.opacity="1",this.textWidth=this.pw_ratio?this.pw_ratio*a.length+this.caretMargin+this.letterSpacing*(a.length-1):getTextWidth(a,this.font)>0?getTextWidth(a,this.font)+this.caretMargin+this.letterSpacing*(a.length-1):this.caretMargin-this.caretWidth/2,this.textWidth>this.maxMargin||(this.caretElem.style.transform=`translateX(${this.textWidth}px)`)}}function initsmoothCarets(){document.querySelectorAll(".sc-container").forEach((a,b)=>{smoothCarets.push(new SmoothCaret(a.children[1],a.children[0],b)),smoothCarets[b].init()}),setInterval(()=>{document.activeElement.getAttribute("data-sc")&&(caretPosString=caretPosString="password"===document.activeElement.type?Array(document.activeElement.value.length+1).join(passwordChar).slice(0,document.activeElement.selectionStart):document.activeElement.value.slice(0,document.activeElement.selectionStart),smoothCarets[parseInt(document.activeElement.dataset.sc)].update(caretPosString))})}initsmoothCarets()
